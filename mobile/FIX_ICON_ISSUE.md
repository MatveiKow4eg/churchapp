# Исправление проблемы с белым placeholder на iOS

## Проблема
При смене иконки на альтернативную, на домашнем экране iOS показывается белый placeholder вместо иконки.

## Причина
iOS агрессивно кэширует иконки приложений. Даже после удаления приложения кэш может сохраняться.

## Решение

### Шаг 1: Полная очистка
```bash
cd mobile
flutter clean
rm -rf ios/Pods ios/Podfile.lock ios/build
```

### Шаг 2: Удаление с устройства
1. На устройстве iOS найдите приложение
2. Долгое нажатие на иконку → "Remove App" → "Delete App"
3. **ВАЖНО:** Перезагрузите устройство (Power Off → Power On)
   - Это очистит кэш иконок iOS

### Шаг 3: Установка заново
```bash
flutter run
```

### Шаг 4: Тестирование
1. Откройте приложение
2. Зайдите в Настройки
3. Выберите любую альтернативную иконку
4. iOS покажет системный диалог подтверждения - нажмите OK
5. Проверьте домашний экран - иконка должна отображаться корректно

## Если проблема сохраняется

### Проверка 1: Убедитесь что иконки сгенерированы правильно
```bash
cd mobile
identify -format "Type: %[type], Alpha: %A\n" "ios/Runner/Assets.xcassets/AppIcon-amber.appiconset/Icon-App-1024x1024@1x.png"
```

Должно быть:
- Type: TrueColor (или Palette)
- Alpha: Undefined (не True!)

### Проверка 2: Визуально проверьте иконку
```bash
cd mobile
open "ios/Runner/Assets.xcassets/AppIcon-amber.appiconset/Icon-App-1024x1024@1x.png"
```

Иконка должна иметь **темно-синий фон** (#0f172a) в углах, а не прозрачный или белый.

### Проверка 3: Пересоздайте иконки
```bash
cd mobile
./fix_ios_icons.sh
flutter clean
# Удалите приложение с устройства
# Перезагрузите устройство
flutter run
```

## Техническая информация

### Формат иконок
- **Формат**: PNG без альфа-канала
- **Тип**: TrueColor RGB (8-bit на канал)
- **Фон**: #0f172a (темно-синий)
- **Обработка**: Composite - иконка накладывается на сплошной фон

### Скрипты
- `fix_ios_icons.sh` - Исправляет существующие иконки
- `generate_ios_icons.sh` - Генерирует иконки с нуля

Оба скрипта используют ImageMagick для создания иконок без прозрачности.

## Важные замечания

1. **Системный диалог iOS** - нормально, его нельзя отключить
2. **Приложение может закрыться** после смены иконки - это нормально для iOS
3. **Кэш иконок** - iOS кэширует иконки очень агрессивно, иногда требуется перезагрузка устройства
4. **Main иконка работает** - потому что она генерируется flutter_launcher_icons и уже имеет правильный формат
